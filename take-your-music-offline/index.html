<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <meta property="og:type" content="website" />
      <meta property="og:url" content="https:&#x2F;&#x2F;blog.orhun.dev"/>
      <meta property="og:title" content="Orhun&#x27;s Blog" />
      <meta property="og:description" content="FOSS ‚Ä¢ Linux ‚Ä¢ Programming"/>
      <meta property="og:image" content="https:&#x2F;&#x2F;blog.orhun.dev/crow.png" />

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
      <link rel="manifest" href="/favicon/site.webmanifest">

      <script async defer data-website-id="56ca5ca7-ba9f-416e-8bee-a132c155d56b" src="https://umami.orhun.dev/umami.js"></script>

      <title>Orhun&#x27;s Blog</title>

      
        <link rel="alternate" type="application/rss+xml" title="RSS" href="https://blog.orhun.dev/rss.xml">
      

      
          <link rel="stylesheet" href="https://blog.orhun.dev/site.css">
      

      
      
    </head>

    <body class="hack dark main container">
        
    
        
                
                    <header>
                        <nav itemscope itemtype="http://schema.org/SiteNavigationElement">
                        
                            <a itemprop="url"
                               class=""
                               href="https:&#x2F;&#x2F;blog.orhun.dev">
                                <span itemprop="name">Home</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https:&#x2F;&#x2F;blog.orhun.dev&#x2F;categories">
                                <span itemprop="name">Categories</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https:&#x2F;&#x2F;github.com&#x2F;orhun&#x2F;personal-blog">
                                <span itemprop="name">Source</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https:&#x2F;&#x2F;blog.orhun.dev&#x2F;rss.xml">
                                <span itemprop="name">RSS</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https:&#x2F;&#x2F;orhun.dev">
                                <span itemprop="name">About</span></a>
                        
                        </nav>
                    </header>
                
            
    

<article itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="headline">Move away from streaming platforms &amp; take your music offline</h1>
        <span class="muted">
    <svg style="margin-bottom:-3px" class="i-clock" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <circle cx="16" cy="16" r="14"/>
        <path d="M16 8 L16 16 20 20"/>
    </svg>
    <span>10 minute read</span>
    <svg style="margin-bottom: -3px" class="i-edit" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <path d="M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z"/>
    </svg>

    Published: 2022-06-03
</span>
    </header>
    <div itemprop="articleBody">
      <p>I don't use <a href="https://en.wikipedia.org/wiki/Spotify">Spotify</a> or any other streaming platform for listening to music. Some call it old habits, some call it needless effort, but I'm very used to downloading <a href="https://en.wikipedia.org/wiki/MP3">MP3</a> files over the internet and putting them in a folder on my phone then using the whatever default media player I have installed. However, for a couple of years, I have been following a better and automated approach for taking my music offline and feeling a bit less like I'm in a <a href="https://en.wikipedia.org/wiki/Consumerism">consumerism</a> bubble.</p>
<span id="continue-reading"></span>
<p>While I'm working, I usually have <a href="https://en.wikipedia.org/wiki/YouTube">YouTube</a> open on one tab playing music. So I created a separate YouTube account/channel dedicated to creating playlists. In my workflow, after saving what I listen to a playlist, the next step would be downloading these tracks as MP3 and transferring them to my phone. But before I dive into details about how I'm doing that, there are some questions that I would like to answer.</p>
<p><strong>Q:</strong> If you already have your music on YouTube, why not use YouTube on your phone?<br />
<strong>A:</strong> I would like to be able to listen to music when I'm offline (i.e. when there is no internet connection).</p>
<p><strong>Q:</strong> Have you heard of <a href="https://music.youtube.com/">YouTube Music</a>?<br />
<strong>A:</strong> Yes, is it free?</p>
<p><strong>Q:</strong> But YouTube is full of ads, isn't it annoying?<br />
<strong>A:</strong> I have an AdBlock extension.</p>
<p><strong>Q:</strong> You are using YouTube at the end of the day. Doesn't it conflict with what you are trying to achieve while saying &quot;move away from streaming platforms&quot;?<br />
<strong>A:</strong> Yes, it is partially true. But I would like to discover new artists/music so I need a &quot;source&quot; for that. I'm only taking the good parts of YouTube (e.g. its algorithm) and self-hosting the rest.</p>
<p><strong>Q:</strong> What about supporting the artists?<br />
<strong>A:</strong> Streaming is not the only way to support an artist.</p>
<p><strong>Q:</strong> Why are you doing this?<br />
<strong>A:</strong> I would like to keep the hard copy of the media that I want to <em>consume</em>. I don't want to leave everything to &quot;the cloud&quot; and I find that wrong. Also, in some cases, I have witnessed the removal of the music that I like since I follow rather obscure artists. Plus, having physical files is great for collecting/archiving purposes. TL;DR: I love files.</p>
<p><strong>Q:</strong> Is this a meme?<br />
<strong>A:</strong> No, check out <a href="https://www.youtube.com/watch?v=wWaWt9d3yw0">&quot;Boomer Yells at Cloud Computing&quot; by Luke Smith</a>.</p>
<h3 id="overview">Overview</h3>
<ol>
<li>Create playlists on YouTube</li>
<li>Download MP3 from YouTube periodically</li>
<li>Synchronize the MP3 files over to your phone</li>
<li>Use an open source MP3 player to listen to music</li>
</ol>
<h3 id="things-that-you-need">Things that you need</h3>
<ul>
<li>A home server (base of operations)
<ul>
<li>I have a <a href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/">Raspberry Pi 4</a> running <a href="https://archlinuxarm.org/">Arch Linux ARM</a></li>
</ul>
</li>
<li>An external drive (for storing MP3 files)
<ul>
<li>I have a 2.5&quot; external hard disk drive with 1TB of storage connected to my Raspberry Pi</li>
</ul>
</li>
<li>A YouTube account (for creating playlists)</li>
<li><a href="https://youtube-dl.org/">youtube-dl</a> (<a href="https://github.com/ytdl-org/youtube-dl">GitHub</a>) (for downloading playlists)</li>
<li><a href="https://f-droid.org/en/packages/org.amoradi.syncopoli/">Syncopoli</a> (<a href="https://gitlab.com/fengshaun/syncopoli">GitLab</a>) (for <code>rsync</code>'ing MP3 files to an <a href="https://en.wikipedia.org/wiki/Android_(operating_system)">Android</a> phone)</li>
<li><a href="https://f-droid.org/packages/com.iven.musicplayergo/">Music Player GO</a> (<a href="https://github.com/enricocid/Music-Player-GO">GitHub</a>) (for actually listening to music)</li>
</ul>
<p><img src="/offline-diagram.png" alt="Diagram" /></p>
<h4 id="setting-up-the-storage">Setting up the storage</h4>
<p><img src="/raspberry-pi.jpg" style="width: 50%" alt="Raspberry Pi"/><br></p>
<p>In my case, I just connected my external hard drive to Raspberry Pi and updated <code>/etc/fstab</code> to mount it on boot.</p>
<pre data-lang="ini" style="background-color:#191919;color:#ffffff;" class="language-ini "><code class="language-ini" data-lang="ini"><span style="background-color:#171717;color:#616161;"># Static information about the filesystems.
</span><span style="background-color:#171717;color:#616161;"># See fstab(5) for details.
</span><span style="color:#cccccc;">
</span><span style="background-color:#171717;color:#616161;"># &lt;file system&gt; &lt;dir&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;
</span><span>/</span><span style="color:#cccccc;">dev</span><span>/</span><span style="color:#cccccc;">sda1       </span><span>/</span><span style="color:#cccccc;">mnt</span><span>/</span><span style="color:#cccccc;">tera exfat rw</span><span>,</span><span style="color:#cccccc;">user</span><span>,</span><span style="color:#cccccc;">uid</span><span>=</span><span style="color:#eddd5a;">1000</span><span>,</span><span style="color:#cccccc;">umask</span><span>=</span><span style="color:#eddd5a;">007</span><span>,</span><span style="color:#cccccc;">exec </span><span style="color:#eddd5a;">0 0
</span></code></pre>
<p>So it will be mounted to <code>/mnt/tera</code> on boot. Note that I have <code>HPFS/NTFS/exFAT</code> filesystem on this drive and your situation might be different.</p>
<p>Next step is creating a separate directory on this drive (since I have some other files) and symlinking it to somewhere more convenient.</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">mkdir</span><span style="font-style:italic;color:#8aa6c1;"> -p</span><span style="color:#cccccc;"> /mnt/tera/backups/YouTube/
</span><span style="color:#cccccc;">ln</span><span style="font-style:italic;color:#8aa6c1;"> -s</span><span style="color:#cccccc;"> /mnt/tera/backups/ /backups
</span></code></pre>
<p>So that I will be able to use <code>/backups</code> as a directory pointing to my backups in the drive. Later on, I will be downloading the MP3 files to <code>/backups/YouTube</code> directory.</p>
<h4 id="creating-a-youtube-account">Creating a YouTube account</h4>
<p>I like having things separated so I suggest having a YouTube channel just for creating playlists. You can create these playlists as public or private since <code>youtube-dl</code> supports both. You can use <a href="https://github.com/ytdl-org/youtube-dl#how-do-i-pass-cookies-to-youtube-dl"><code>--cookies</code></a> argument for specifying a cookie if needed.</p>
<p>Then you can start creating playlists as you are discovering new music/artists thanks to the great algorithm of YouTube!</p>
<p><img src="/youtube-playlists.png" alt="YouTube Playlists" /></p>
<h4 id="downloading-playlists">Downloading playlists</h4>
<p>In order to keep track of the downloaded videos (tracks), we will need to use <a href="https://github.com/ytdl-org/youtube-dl#how-do-i-download-only-new-videos-from-a-playlist"><code>download-archive</code></a> feature of <code>youtube-dl</code>.</p>
<blockquote>
<p>With this feature you should initially download the complete playlist with --download-archive /path/to/download/archive/file.txt that will record identifiers of all the videos in a special file. Each subsequent run with the same --download-archive will download only new videos and skip all videos that have been downloaded before. Note that only successful downloads are recorded in the file.</p>
</blockquote>
<p>So running the following command will suffice our needs and download the each playlist in their designated folder:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">$ youtube-dl \
</span><span style="font-style:italic;color:#8aa6c1;">    --socket-timeout</span><span style="color:#cccccc;"> 15 \
</span><span style="font-style:italic;color:#8aa6c1;">    --ignore-errors </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --extract-audio </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --audio-format</span><span style="color:#cccccc;"> mp3 \
</span><span style="font-style:italic;color:#8aa6c1;">    --audio-quality</span><span style="color:#cccccc;"> 0 \
</span><span style="font-style:italic;color:#8aa6c1;">    --add-metadata </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --metadata-from-title</span><span>=</span><span style="color:#ffd700;">&quot;%(artist)s - %(title)s&quot; </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --embed-thumbnail </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --download-archive </span><span style="color:#ffd700;">&quot;.archive&quot; </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --output </span><span style="color:#ffd700;">&#39;%(playlist)s/%(title)s.%(ext)s&#39; </span><span style="color:#cccccc;">\
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;https://www.youtube.com/channel/&lt;channel_id&gt;/playlists&quot;
</span></code></pre>
<p>Each directory will contain the MP3 files from that playlist:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">$ ls patapon/ sonic/
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">patapon/:
</span><span style="color:#ffd700;">&quot;09. Moudamepon&#39;s Theme - Disk 2 - Patapon Complete Soundtrack.mp3&quot;
</span><span style="color:#ffd700;">&#39;Patapon Soundtrack - 10 „Éì„Éì„É™„ÉÉ„ÉÅ„ÅÆ„ÉÜ„Éº„Éû.mp3&#39;
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">sonic/:
</span><span style="color:#ffd700;">&#39;Burning Depths - Sonic &amp; All-Stars Racing Transformed [OST].mp3&#39;
</span><span style="color:#ffd700;">&#39;Disquieting Shadow - Sonic Heroes [OST].mp3&#39;
</span></code></pre>
<p>List of video IDs will be stored in <code>.archive</code>:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">youtube Hcrkbtcjoi4
</span><span style="color:#cccccc;">youtube Hn1vLFDm98I
</span><span style="color:#cccccc;">youtube _pUL7u-mYqA
</span><span style="color:#cccccc;">...
</span></code></pre>
<p>Also, I wanted to keep track of what I have added to this list so I've used a git repository. Here is the final script:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="background-color:#171717;color:#616161;">#!/usr/bin/env bash
</span><span style="color:#cccccc;">
</span><span style="color:#8aa6c1;">set </span><span style="font-style:italic;color:#8aa6c1;">-e
</span><span style="color:#cccccc;">
</span><span style="color:#8aa6c1;">cd</span><span style="color:#cccccc;"> /backups/YouTube/
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">youtube-dl \
</span><span style="font-style:italic;color:#8aa6c1;">    --socket-timeout</span><span style="color:#cccccc;"> 15 \
</span><span style="font-style:italic;color:#8aa6c1;">    --ignore-errors </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --extract-audio </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --audio-format</span><span style="color:#cccccc;"> mp3 \
</span><span style="font-style:italic;color:#8aa6c1;">    --audio-quality</span><span style="color:#cccccc;"> 0 \
</span><span style="font-style:italic;color:#8aa6c1;">    --add-metadata </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --metadata-from-title</span><span>=</span><span style="color:#ffd700;">&quot;%(artist)s - %(title)s&quot; </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --embed-thumbnail </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --download-archive </span><span style="color:#ffd700;">&quot;.archive&quot; </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    --output </span><span style="color:#ffd700;">&#39;%(playlist)s/%(title)s.%(ext)s&#39; </span><span style="color:#cccccc;">\
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;https://www.youtube.com/channel/&lt;channel_id&gt;/playlists&quot;
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">git add .archive
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">git</span><span style="font-style:italic;color:#8aa6c1;"> -c</span><span style="color:#cccccc;"> user.name=</span><span style="color:#ffd700;">&quot;ytdl&quot; </span><span style="color:#cccccc;">\
</span><span style="font-style:italic;color:#8aa6c1;">    -c</span><span style="color:#cccccc;"> user.email=</span><span style="color:#ffd700;">&quot;ytdl@git&quot; </span><span style="color:#cccccc;">\
</span><span style="color:#cccccc;">    commit</span><span style="font-style:italic;color:#8aa6c1;"> -m </span><span style="color:#ffd700;">&quot;upd: v$(date +&#39;%s&#39;)&quot;
</span></code></pre>
<h4 id="setting-up-the-cronjob">Setting up the cronjob</h4>
<p>Now we will need to create a <a href="https://en.wikipedia.org/wiki/Cron">cronjob</a> for periodically downloading the playlists using the previous script.</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">$ crontab</span><span style="font-style:italic;color:#8aa6c1;"> -e </span><span style="background-color:#171717;color:#616161;"># edit user&#39;s crontab
</span><span style="color:#cccccc;">
</span><span style="color:#cccccc;">$ crontab</span><span style="font-style:italic;color:#8aa6c1;"> -l </span><span style="background-color:#171717;color:#616161;"># list cronjobs
</span><span style="color:#cccccc;">0 0 </span><span>* *</span><span style="color:#cccccc;"> 0 /backups/YouTube/fetch.sh
</span></code></pre>
<p>This cronjob will run <a href="https://crontab.guru/#0_0_*_*_0">weekly</a> and download the playlists.</p>
<p>Here is what <code>git log</code> will look like after you let it run for a couple of weeks:</p>
<pre style="background-color:#191919;color:#ffffff;"><code><span>commit 0abef26b3dbef43f15e0172190b2e802d38ed5c3
</span><span>Author: ytdl &lt;ytdl@git&gt;
</span><span>Date:   Sun May 22 02:54:50 2022 +0300
</span><span>
</span><span>    upd: v1653177290
</span><span>
</span><span>commit ef7ec0d63616d82ce3cc942e2edddf1452063208
</span><span>Author: ytdl &lt;ytdl@git&gt;
</span><span>Date:   Sun May 15 00:48:31 2022 +0300
</span><span>
</span><span>    upd: v1652564911
</span><span>
</span><span>commit 0c0af6ea38c8f07990d7954f6f69ab592ff49c38
</span><span>Author: ytdl &lt;ytdl@git&gt;
</span><span>Date:   Sun May 8 00:32:26 2022 +0300
</span><span>
</span><span>    upd: v1651959146
</span></code></pre>
<h4 id="syncing-the-files">Syncing the files</h4>
<p>I'm using <a href="https://gitlab.com/fengshaun/syncopoli">Syncopoli</a> to <a href="https://en.wikipedia.org/wiki/Rsync">rsync(1)</a> files over to my phone. It is a really simple yet effective application. Some parts are still WIP but you can head to the <a href="https://gitlab.com/fengshaun/syncopoli">repository</a> and contribute if you're interested.</p>
<p>Main screen:</p>
<img src="/syncopoli_main_screen.jpg" style="width: 50%" alt="Syncopoli main screen"/>
<p>Settings:</p>
<img src="/syncopoli_settings.jpg" style="width: 50%" alt="Syncopoli settings"/>
<p>I had a couple of issues with my settings so it is always a good idea to monitor the SSH connection attempts on your server while trying out <code>Syncopoli</code>:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">$ journalctl</span><span style="font-style:italic;color:#8aa6c1;"> -f -u</span><span style="color:#cccccc;"> sshd
</span></code></pre>
<p>In my case, this command greatly helped me to spot issues like the following:</p>
<blockquote>
<p>fatal: Timeout before authentication for 192.168.1.37 port 60044</p>
</blockquote>
<blockquote>
<p>error: maximum authentication attempts exceeded for orhun from 192.168.1.37 port 60038 ssh2 [preauth]</p>
</blockquote>
<p>Also, you can use <a href="https://f-droid.org/en/packages/com.dp.logcatapp/">Logcat Reader</a> to see which <code>rsync</code> commands are being run and what has failed.</p>
<img src="/syncopoli_logcat_reader.jpg" style="width: 60%" alt="Logcat Reader"/>
<p>For me, the biggest challenge was to use my private key for the SSH connection. To do that, you <a href="https://gitlab.com/fengshaun/syncopoli#ssh-key">need to</a> convert your key to <a href="https://en.wikipedia.org/wiki/Dropbear_(software)">dropbear</a> format:</p>
<pre data-lang="sh" style="background-color:#191919;color:#ffffff;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#cccccc;">$ dropbearconvert openssh dropbear </span><span>&lt;</span><span style="color:#cccccc;">openssh_private_key</span><span>&gt; &lt;</span><span style="color:#cccccc;">dropbear_output_file</span><span>&gt;
</span></code></pre>
<p>But even though I did this, I still couldn't connect:</p>
<blockquote>
<p>userauth_pubkey: signature algorithm ssh-rsa not in PubkeyAcceptedAlgorithms [preauth]</p>
</blockquote>
<p>I solved this issue by adding the following line to my <code>/etc/ssh/sshd_config</code> and restarting <code>sshd</code>:</p>
<pre style="background-color:#191919;color:#ffffff;"><code><span>PubkeyAcceptedKeyTypes=+ssh-rsa
</span></code></pre>
<p>Then everything worked perfectly and I managed to transfer files to my phone.</p>
<p><img src="/syncopoli_transfer.jpg" style="width: 50%" alt="Syncopoli transfer"/><br></p>
<p>Here is what my sync profile looks like:</p>
<p><img src="/syncopoli_profile.jpg" style="width: 50%" alt="Syncopoli profile"/><br></p>
<p>JSON export:</p>
<pre data-lang="json" style="background-color:#191919;color:#ffffff;" class="language-json "><code class="language-json" data-lang="json"><span style="color:#cccccc;">{
</span><span style="color:#cccccc;">  </span><span style="color:#ffd700;">&quot;version&quot;</span><span style="color:#cccccc;">: </span><span style="color:#eddd5a;">2</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">  </span><span style="color:#ffd700;">&quot;globals&quot;</span><span style="color:#cccccc;">: {
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_server_address&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&lt;server&gt;&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_protocol&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;SSH&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_username&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;orhun&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_rsync_password&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_options&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;-vrlt --no-perms&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_private_key&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;/sdcard/alarm_dropbear.sec&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_port&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&lt;port&gt;&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_frequency&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;12&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_ssh_password&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_wifi_only&quot;</span><span style="color:#cccccc;">: </span><span style="color:#80d500;">true</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_wifi_name&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">    </span><span style="color:#ffd700;">&quot;pref_key_as_root&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;&quot;
</span><span style="color:#cccccc;">  },
</span><span style="color:#cccccc;">  </span><span style="color:#ffd700;">&quot;profiles&quot;</span><span style="color:#cccccc;">: [
</span><span style="color:#cccccc;">    {
</span><span style="color:#cccccc;">      </span><span style="color:#ffd700;">&quot;name&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;Sync Music&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">      </span><span style="color:#ffd700;">&quot;sources&quot;</span><span style="color:#cccccc;">: [
</span><span style="color:#cccccc;">        </span><span style="color:#ffd700;">&quot;../../backups/YouTube/&quot;
</span><span style="color:#cccccc;">      ],
</span><span style="color:#cccccc;">      </span><span style="color:#ffd700;">&quot;destination&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;/sdcard/Music/YouTube/&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">      </span><span style="color:#ffd700;">&quot;rsync_options&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;-zhPu --exclude </span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;">.git*</span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;"> --exclude </span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;">.archive</span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;"> --exclude </span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;">*.sh</span><span style="font-weight:bold;color:#ff2837;">\&quot;</span><span style="color:#ffd700;">&quot;</span><span style="color:#cccccc;">,
</span><span style="color:#cccccc;">      </span><span style="color:#ffd700;">&quot;direction&quot;</span><span style="color:#cccccc;">: </span><span style="color:#ffd700;">&quot;INCOMING&quot;
</span><span style="color:#cccccc;">    }
</span><span style="color:#cccccc;">  ]
</span><span style="color:#cccccc;">}
</span></code></pre>
<p>I had to use <code>../../</code> for the origin directory since <code>rsync</code> is launched from <code>$HOME</code> as default. Maybe there is another way to achieve this but this worked well so I didn't look into other options. If you know a better way, let me know!</p>
<h4 id="tweaking-rsync-settings">Tweaking rsync settings</h4>
<p>The default arguments that are passed to <code>rsync</code> are the following:</p>
<ul>
<li><code>--verbose, -v</code>: increase verbosity</li>
<li><code>--recursive, -r</code>: recurse into directories</li>
<li><code>--links, -l</code>: copy symlinks as symlinks</li>
<li><code>-times, -t</code>: preserve modification times</li>
<li><code>--no-perms</code>: do not preserve permissions</li>
</ul>
<p>Additionally, I'm using the following flags/arguments:</p>
<ul>
<li><code>--compress, -z</code>: compress file data during the transfer</li>
<li><code>--human-readable, -h</code>: output numbers in a human-readable format</li>
<li><code>-P</code>: equivalent to <code>--partial --progress</code>. Its purpose is to make it much easier to specify these two options for a long transfer that may be interrupted.</li>
<li><code>--update, -u</code>: skip files that are newer on the receiver</li>
<li><code>--exclude=PATTERN</code>: exclude files matching PATTERN</li>
</ul>
<p>Keep in mind that you can use <code>--dry-run, -n</code> flag to perform a trial run. It is also a good idea to create another profile on <code>Syncopoli</code> for dry-run.</p>
<p>I also suggest having albums and long mixes in a separate playlist so that you can <code>--exclude</code> them with <code>rsync</code> to avoid long download times.</p>
<h4 id="listening-to-music-notes">Listening to music üé∂</h4>
<p>After going through all these steps and automating the download/sync process, there is one simple thing left to do: feed your soul with music via <a href="https://github.com/enricocid/Music-Player-GO">Music Player GO</a>!</p>
<p><img src="/music-player-go.jpg" style="width: 90%" alt="Music Player GO"/><br></p>
<p>And there you have it, an alternative approach to how you can enjoy listening to music offline while actually owning <em>the data</em>.</p>
<p>Consider supporting me on <a href="https://github.com/sponsors/orhun">GitHub Sponsors</a> or <a href="https://www.patreon.com/orhunp">Patreon</a> :3</p>
<p>Take care!</p>

    </div>

    
        <footer>
            <hr>
            <p>
                
                    Published by Orhun Parmaksƒ±z
                
                
                    
                    in <a href="https://blog.orhun.dev/categories/guides/">Guides</a>
                
                
            </p>
            
            
            <iframe src="https://github.com/sponsors/orhun/button" title="Sponsor @orhun" height="35" width="116" style="border: 0;"></iframe>
            <script src="https://utteranc.es/client.js"
                    repo="orhun/personal-blog"
                    issue-term="url"
                    label="comments"
                    theme="github-dark"
                    crossorigin="anonymous"
                    async>
            </script>
        </footer>
    
</article>


    </body>

</html>
